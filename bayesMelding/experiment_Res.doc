26/01/2018
The 1 round of optimisation : only one length-scale parameter
minus_log_like for repeat 1 is [array(-963.1197030241307)]
running time for one round of optimisation is 105.062617064 
estimated length scale is [ 1.00344052]

29/01/2018
The 1st round of optimisation
minus_log_like for repeat 1 is [array(-963.1999985773231)]
running time for one round of optimisation is 288.931998014
estimated length scale is [ 1.17107707  1.02117847]
estimated hess_inv is [[ 0.00444735  0.0037533 ]
 [ 0.0037533   0.00470113]]

The 2nd round of optimisation
minus_log_like for repeat 1 is [array(-963.1866095972637)]
running time for one round of optimisation is 428.233564854
estimated length scale is [ 1.09784081  1.01253962]
estimated hess_inv is [[ 0.06073163  0.00584974]
 [ 0.00584974  0.00172209]]

 The 95% confidence interval for sigma is [0.975, 1.237]
 The 95% confidence interval for length-scale is [1.009, 1.016]

 The 3rd round of optimisation
minus_log_like for repeat 1 is [array(-963.1802637404967)]
running time for one round of optimisation is 222.905239105
estimated length scale is [ 1.16535419  1.02836871]
estimated hess_inv is [[ 0.0031897   0.00199629]
 [ 0.00199629  0.0012494 ]]

 The 95% confidence interval for sigma is [1.158, 1.173]
 The 95% confidence interval for length-scale is [1.026, 1.031]


The 1 round of optimisation
minus_log_like for repeat 1 is [array(-963.1991250151008)]
log_parameters after optimisation is :[ 0.17436764  0.02297406]
covariance of log_pars after optimisation is :[[  8.13471977e-08  -6.36498087e-08]
 [ -6.36498087e-08   6.47285031e-08]]
Log_parameters after burningin is :[-0.39962734 -0.0036527 ]
cov of log_pars after burningin is :[[ 0.04398047  0.        ]
 [ 0.          0.04398047]]
Acc_Rate:0.2
running time for one round of MH estimation is 2745.216537

sample size = 100
minus_log_like for repeat 5 is [array(-963.1996357548809) array(-963.1287384797932)
 array(-963.1967800576242) array(-963.1986050422441)
 array(-963.1992121514938)]
log_parameters after optimisation is :[ 0.14864699  0.0190629 ]
parameters after optimisation is :[ 1.16026333  1.01924576]
covariance of log_pars after optimisation is :[[ 0.11824511  0.0127454 ]
 [ 0.0127454   0.0029875 ]]
log_parameters after burningin is :[ 0.12148062  0.09232061]
parameters after burningin is :[ 1.12916748  1.09671638]
cov of log_pars after burningin is :[[ 0.06871948  0.        ]
 [ 0.          0.06871948]]
Acc_Rate:0.16
running time for MH estimation of size 100 is 4598.52162886
estimated mean of parameters is [ 1.35780124  1.02451798]
estimated std of parameters is [ 0.38128     0.05163649]


The 95% confidence interval for sigma is [0.60, 2.12]
The 95% confidence interval for length-scale is [0.92, 1.13]

The 68% confidence interval for sigma is [0.99, 1.74]
The 68% confidence interval for length-scale is [0.97, 1.08]

The 1 round of optimisation
minus_log_like for repeat 1 is [array(-963.2000090605775)]
log_parameters after optimisation is :[ 0.15684792  0.0204444 ]
parameters after optimisation is :[ 1.16981769  1.02065482]
covariance of log_pars after optimisation is :[[ 0.01583952 -0.00021516]
 [-0.00021516  0.00184965]]
log_parameters after burningin is :[ 0.39074538  0.10367643]
parameters after burningin is :[ 1.47808212  1.10924147]
cov of log_pars after burningin is :[[ 0.09441091 -0.00128244]
 [-0.00128244  0.01102475]]
Acc_Rate:0.32
running time for MH estimation of size 100 is 1751.09583497 seconds
estimated mean of parameters is [ 1.78227945  1.05589452]
estimated std of parameters is [ 0.79638753  0.07351853]


sample size = 1000, no burningin – the acceptance rate appears to be high
he 1 round of optimisation
minus_log_like for repeat 1 is [array(-963.2000122063898)]
log_parameters after optimisation is :[ 0.1568409   0.02068716]
parameters after optimisation is :[ 1.16980948  1.02090263]
covariance of log_pars after optimisation is :[[ 0.13362802  0.00985161]
 [ 0.00985161  0.00213232]]
Acc_Rate:0.567
running time for MH estimation of size 1000 is 2298.48481202 seconds
estimated mean of parameters is [ 1.41232699  1.03007872]
estimated std of parameters is [ 0.65402802  0.06048832]

30/01/2018 
1)burningin with covariance derived from optimisation– the values of covariance are nearly zeros and the acceptance rate appears to be 1 for a long time
The 1 round of optimisation
minus_log_like for repeat 1 is [array(-963.1995163548643)]
log_parameters after optimisation is :[ 0.1704495   0.02234061]
parameters after optimisation is :[ 1.18583777  1.02259203]
covariance of log_pars after optimisation is :[[  1.09102514e-07  -1.59398137e-08]
 [ -1.59398137e-08   2.36279033e-09]]
Acc_Rate for the 0 iteration is 1.0
Acc_Rate for the 1 iteration is 1.0
Acc_Rate for the 2 iteration is 1.0


2)burningin with covariance being identity 

i) maximum likelihood methods – mean [ 1.09794266  1.0100825 ], the true value is with one std range sigma [0.70, 1.50], length-scale[0.98, 1.04]
ii) MH – with 23% acceptance rate, mean [ 1.59663726  1.04325845]
larger mean with a larger variance, sigma [0.75, 2.43],length-sacle [0.98,1.10]

The 1 round of optimisation
minus_log_like for repeat 1 is [array(-963.1830606365662)]
log_parameters after optimisation is :[ 0.09343812  0.01003201]
parameters after optimisation is :[ 1.09794266  1.0100825 ]
covariance of log_pars after optimisation is :[[ 0.17286307 -0.00954887]
 [-0.00954887  0.00089831]]


Acc_Rate for the 0 iteration is 0.04
Acc_Rate for the 1 iteration is 0.04
Acc_Rate for the 2 iteration is 0.02
Acc_Rate for the 3 iteration is 0.01
Acc_Rate for the 4 iteration is 0.0
Acc_Rate for the 5 iteration is 0.05
Acc_Rate for the 6 iteration is 0.03
Acc_Rate for the 7 iteration is 0.07
Acc_Rate for the 8 iteration is 0.12
Acc_Rate for the 9 iteration is 0.18
Acc_Rate for the 10 iteration is 0.14
Acc_Rate for the 11 iteration is 0.15
Acc_Rate for the 12 iteration is 0.17
Acc_Rate for the 13 iteration is 0.23
log_parameters after burningin is :[ 0.35721892  0.04945951]
parameters after burningin is :[ 1.42934875  1.05070305]
cov of log_pars after burningin is :[[ 0.05497558  0.        ]
 [ 0.          0.05497558]]
Acc_Rate:0.22
running time for MH estimation of size 1000 is 3591.13037205 seconds
estimated mean of parameters is [ 1.59663726  1.04325845]
estimated std of parameters is [ 0.84067095  0.06113411]

The 1 round of optimisation
minus_log_like for repeat 1 is [array(-963.1964013607834)]
log_parameters after optimisation is :[ 0.12506753  0.01612674]
parameters after optimisation is :[ 1.13322497  1.01625748]
covariance of log_pars after optimisation is :[[ 0.09492564  0.00937564]
 [ 0.00937564  0.00211688]]
Acc_Rate for the 0 iteration is 0.62
Acc_Rate for the 1 iteration is 0.56
Acc_Rate for the 2 iteration is 0.47
Acc_Rate for the 3 iteration is 0.42
Acc_Rate for the 4 iteration is 0.46
Acc_Rate for the 5 iteration is 0.41
Acc_Rate for the 6 iteration is 0.38
log_parameters after burningin is :[-0.27860601 -0.00346469]
parameters after burningin is :[ 0.75683803  0.9965413 ]
cov of log_pars after burningin is :[[ 0.36211256  0.03576522]
 [ 0.03576522  0.00807525]]
Acc_Rate:0.412
running time for MH estimation of size 1000 is 2661.82218599 seconds
estimated mean of parameters is [ 1.41859596  1.02395987]
estimated std of parameters is [ 0.68851157  0.06206967]
ModeResult(mode=array([[ 1.2548263 ],
       [ 1.00635602]]), count=array([[17],
       [17]]))

The 1 round of optimisation
minus_log_like for repeat 1 is [array(-963.1832352266779)]
log_parameters after optimisation is :[ 0.08474744  0.01239072]
parameters after optimisation is :[ 1.08844214  1.01246781]
covariance of log_pars after optimisation is :[[ 0.18425574  0.03545867]
 [ 0.03545867  0.00801735]]
Acc_Rate for the 0 iteration is 0.04
Acc_Rate for the 1 iteration is 0.04
Acc_Rate for the 2 iteration is 0.07
Acc_Rate for the 3 iteration is 0.03
Acc_Rate for the 4 iteration is 0.04
Acc_Rate for the 5 iteration is 0.03
Acc_Rate for the 6 iteration is 0.05
Acc_Rate for the 7 iteration is 0.06
Acc_Rate for the 8 iteration is 0.1
Acc_Rate for the 9 iteration is 0.09
Acc_Rate for the 10 iteration is 0.15
Acc_Rate for the 11 iteration is 0.14
Acc_Rate for the 12 iteration is 0.18
Acc_Rate for the 13 iteration is 0.18
Acc_Rate for the 14 iteration is 0.22
log_parameters after burningin is :[ 0.00811312 -0.00270107]
parameters after burningin is :[ 1.00814612  0.99730257]
cov of log_pars after burningin is :[[ 0.04398047  0.        ]
 [ 0.          0.04398047]]
Acc_Rate:0.1905
running time for MH estimation of size 2000 is 5230.92836809 seconds
estimated mean of parameters is [ 1.34354237  1.01935572]
estimated std of parameters is [ 0.75474863  0.05954957]

31/01/2018:
1)Adding the prior likelihood – the results of the optimisation and MH estimation are closer to the true value
2)When optimising, re-optimise if the diagonal of the covariance is less than 1e-4 - because using this covariance for tuning is much quicker than using the identity matrix, it is greater than 1e-4, the acceptance rate is always 1 at the beginning of the turning

The 1 round of optimisation – proposal = ‘identity’
minus_log_like for repeat 1 is [array(-959.4178528195442)]
log_parameters after optimisation is :[ 0.05919613  0.01251284]
parameters after optimisation is :[ 1.06098332  1.01259146]
covariance of log_pars after optimisation is :[[  9.75573177e-08  -2.41763778e-08]
 [ -2.41763778e-08   6.03720636e-09]]
Acc_Rate for the 0 iteration is 0.02
Acc_Rate for the 1 iteration is 0.01
Acc_Rate for the 2 iteration is 0.02
Acc_Rate for the 3 iteration is 0.05
Acc_Rate for the 4 iteration is 0.05
Acc_Rate for the 5 iteration is 0.07
Acc_Rate for the 6 iteration is 0.06
Acc_Rate for the 7 iteration is 0.05
Acc_Rate for the 8 iteration is 0.12
Acc_Rate for the 9 iteration is 0.14
Acc_Rate for the 10 iteration is 0.09
Acc_Rate for the 11 iteration is 0.14
Acc_Rate for the 12 iteration is 0.11
Acc_Rate for the 13 iteration is 0.13
Acc_Rate for the 14 iteration is 0.16
Acc_Rate for the 15 iteration is 0.23
log_parameters after burningin is :[ 0.38528362  0.06538815]
parameters after burningin is :[ 1.4700312   1.06757332]
cov of log_pars after burningin is :[[ 0.03518437  0.        ]
 [ 0.          0.03518437]]
Acc_Rate:0.233333333333
running time for MH estimation of size 120 is 2777.43016505 seconds
estimated mod of parameters is ModeResult(mode=array([[ 1.4700312 ],
       [ 1.06757332]]), count=array([[17],
       [17]]))
estimated mean of parameters is [ 1.13081777  1.01501518]
estimated std of parameters is [ 0.32415243  0.05330218]

Much better results and quicker running time after improving the codes using the above 1)&2) – see below 

he 1 round of optimisation - proposal = ‘fullApproxCov’
minus_log_like for repeat 1 is [array(-959.4234813590592)]
log_parameters after optimisation is :[ 0.0512823   0.00900097]
parameters after optimisation is :[ 1.05262001  1.0090416 ]
covariance of log_pars after optimisation is :[[ 0.00087341  0.00402783]
 [ 0.00402783  0.01857477]]
Acc_Rate for the 0 iteration is 0.27
log_parameters after burningin is :[ 0.04757066 -0.00857996]
parameters after burningin is :[ 1.0487203   0.99145674]
cov of log_pars after burningin is :[[ 0.00087341  0.00402783]
 [ 0.00402783  0.01857477]]
Acc_Rate:0.333333333333
running time for MH estimation of size 150 is 801.033923149 seconds
estimated mod of parameters is ModeResult(mode=array([[ 1.07258115],
       [ 1.10158933]]), count=array([[9],
       [9]]))
estimated mean of parameters is [ 1.05526705  1.02226996]
estimated std of parameters is [ 0.01084307  0.04812421]

The 1 round of optimisation
minus_log_like for repeat 1 is [array(-959.4253822399111)]
log_parameters after optimisation is :[-0.03523497 -0.00057196]
parameters after optimisation is :[ 0.96537855  0.99942821]
covariance of log_pars after optimisation is :[[  4.81639688e-07   3.13731171e-05]
 [  3.13731171e-05   2.04358673e-03]]
diag of the hess_inv is [  4.81639688e-07   2.04358673e-03]
The 1 round of optimisation
minus_log_like for repeat 1 is [array(-959.4297807184529)]
log_parameters after optimisation is :[ 0.02913699  0.00692057]
parameters after optimisation is :[ 1.02956562  1.00694458]
covariance of log_pars after optimisation is :[[ 0.02529336 -0.00292523]
 [-0.00292523  0.00033831]]
Acc_Rate for the 0 iteration is 0.64
Acc_Rate for the 1 iteration is 0.68
Acc_Rate for the 2 iteration is 0.58
Acc_Rate for the 3 iteration is 0.66
Acc_Rate for the 4 iteration is 0.63
Acc_Rate for the 5 iteration is 0.5
Acc_Rate for the 6 iteration is 0.51
Acc_Rate for the 7 iteration is 0.48
Acc_Rate for the 8 iteration is 0.44
Acc_Rate for the 9 iteration is 0.44
Acc_Rate for the 10 iteration is 0.37
log_parameters after burningin is :[ 0.19938126 -0.01360022]
parameters after burningin is :[ 1.22064726  0.98649184]
cov of log_pars after burningin is :[[ 0.23556279 -0.02724336]
 [-0.02724336  0.00315076]]
Acc_Rate:0.371666666667
running time for MH estimation of size 1200 is 4507.65981817 seconds
estimated mod of parameters is ModeResult(mode=array([[ 0.96249949],
       [ 1.00758471]]), count=array([[13],
       [13]]))
estimated mean of parameters is [ 1.0667752   1.00424125]
estimated std of parameters is [ 0.1744702   0.01896624]

3 parameters estimation:

The 1 round of optimisation
minus_log_like for repeat 1 is [array(-956.224284327116)]
log_parameters after optimisation is :[ 0.03380422  0.01325176 -2.33786598]
parameters after optimisation is :[ 1.03438208  1.01333996  0.09653342]
covariance of log_pars after optimisation is :[[  2.70171278e-08   2.25448023e-08  -6.85714012e-07]
 [  2.25448023e-08   1.88954730e-08  -6.85066381e-08]
 [ -6.85714012e-07  -6.85066381e-08   3.16692761e-03]]
diag of the hess_inv is [  2.70171278e-08   1.88954730e-08   3.16692761e-03]
The 1 round of optimisation
minus_log_like for repeat 1 is [array(-956.246547999127)]
log_parameters after optimisation is :[ -1.49177155e-02   9.66662248e-04  -2.33265542e+00]
parameters after optimisation is :[ 0.985193    1.00096713  0.09703773]
covariance of log_pars after optimisation is :[[  6.09633733e-04   1.89305667e-04  -1.44661050e-03]
 [  1.89305667e-04   5.87839585e-05  -4.49360009e-04]
 [ -1.44661050e-03  -4.49360009e-04   8.39087263e-03]]
Acc_Rate for the 0 iteration is 0.51
Acc_Rate for the 1 iteration is 0.49
Acc_Rate for the 2 iteration is 0.48
Acc_Rate for the 3 iteration is 0.45
Acc_Rate for the 4 iteration is 0.42
Acc_Rate for the 5 iteration is 0.31
log_parameters after burningin is :[ 0.04818092  0.02045065 -2.33408158]
parameters after burningin is :[ 1.04936049  1.0206612   0.09689944]
cov of log_pars after burningin is :[[ 0.00186045  0.00057772 -0.0044147 ]
 [ 0.00057772  0.00017939 -0.00137134]
 [-0.0044147  -0.00137134  0.02560691]]
Acc_Rate:0.352
running time for MH estimation of size 125 is 2249.86711502 seconds
estimated mod of parameters is ModeResult(mode=array([[ 0.94186244],
       [ 0.98705786],
       [ 0.09491256]]), count=array([[8],
       [8],
       [8]]))
estimated mean of parameters is [ 0.93410159  0.98274864  0.0976913 ]
estimated std of parameters is [ 0.12144455  0.03943737  0.00528264]

The 1 round of optimisation
minus_log_like for repeat 1 is [array(-956.2468710519204)]
log_parameters after optimisation is :[ 0.02275014  0.00524663 -2.33230877]
parameters after optimisation is :[ 1.02301089  1.00526042  0.09707137]
covariance of log_pars after optimisation is :[[  3.29773048e-03   3.67958086e-05  -1.56756426e-04]
 [  3.67958086e-05   8.25715261e-04  -5.37000760e-06]
 [ -1.56756426e-04  -5.37000760e-06   2.99383798e-03]]
diag of the hess_inv is [ 0.00329773  0.00082572  0.00299384]
Acc_Rate for the 0 iteration is 0.59
Acc_Rate for the 1 iteration is 0.63
Acc_Rate for the 2 iteration is 0.53
Acc_Rate for the 3 iteration is 0.42
Acc_Rate for the 4 iteration is 0.46
Acc_Rate for the 5 iteration is 0.36
log_parameters after burningin is :[ 0.45630172  0.05610971 -2.26438858]
parameters after burningin is :[ 1.57822645  1.05771372  0.10389354]
cov of log_pars after burningin is :[[  1.00638748e-02   1.12291896e-04  -4.78382646e-04]
 [  1.12291896e-04   2.51988300e-03  -1.63879627e-05]
 [ -4.78382646e-04  -1.63879627e-05   9.13646845e-03]]
Acc_Rate:0.362727272727
running time for MH estimation of size 1100 is 2528.23053408 seconds
estimated mod of parameters is ModeResult(mode=array([[ 1.03211381],
       [ 1.02171698],
       [ 0.10186649]]), count=array([[14],
       [14],
       [14]]))
estimated mean of parameters is [ 1.23970644  1.01466868  0.0970893 ]
estimated std of parameters is [ 0.48844974  0.06105857  0.005257  ]

02/02/2018: reconstructed the correct joint covariance matrix of hat(Zs) and tild(Zs) – including the point-areal covariance

The 1 round of optimisation
minus_log_like for repeat 1 is [array(-975.156382054081)]
log_parameters after optimisation is :[-0.20403088 -0.01235269 -2.31489561]
parameters after optimisation is :[ 0.81543719  0.98772329  0.0987765 ]
covariance of log_pars after optimisation is :[[ 0.1644554   0.01228192 -0.00486493]
 [ 0.01228192  0.00321375 -0.00061426]
 [-0.00486493 -0.00061426  0.00173876]]
diag of the hess_inv is [ 0.1644554   0.00321375  0.00173876]
Acc_Rate for the 0 iteration is 0.48
Acc_Rate for the 1 iteration is 0.46
Acc_Rate for the 2 iteration is 0.36
log_parameters after burningin is :[ 0.28948546  0.09935994 -2.18764083]
parameters after burningin is :[ 1.33574002  1.10446377  0.11218109]
cov of log_pars after burningin is :[[ 0.25696156  0.01919051 -0.00760145]
 [ 0.01919051  0.00502148 -0.00095978]
 [-0.00760145 -0.00095978  0.00271682]]
Acc_Rate:0.36
running time for MH estimation of size 100 is 1183.4768641 seconds
estimated mod of parameters is ModeResult(mode=array([[ 0.88722114],
       [ 0.97830377],
       [ 0.10232392]]), count=array([[11],
       [11],
       [11]]))
estimated mean of parameters is [ 1.19460793  1.01371403  0.10129725]
estimated std of parameters is [ 0.41275385  0.04938694  0.00519894]

The 1 round of optimisation
minus_log_like for repeat 1 is [array(-975.1569778821785)]
log_parameters after optimisation is :[-0.17531122 -0.00984558 -2.31500635]
parameters after optimisation is :[ 0.8391958   0.99020273  0.09876556]
covariance of log_pars after optimisation is :[[ 0.00177285 -0.00143904 -0.00140339]
 [-0.00143904  0.00116811  0.00113915]
 [-0.00140339  0.00113915  0.00111094]]
diag of the hess_inv is [ 0.00177285  0.00116811  0.00111094]
Acc_Rate for the 0 iteration is 0.7
Acc_Rate for the 1 iteration is 0.65
Acc_Rate for the 2 iteration is 0.61
Acc_Rate for the 3 iteration is 0.64
Acc_Rate for the 4 iteration is 0.52
Acc_Rate for the 5 iteration is 0.53
Acc_Rate for the 6 iteration is 0.36
log_parameters after burningin is :[-0.14736398 -0.03092465 -2.33647107]
parameters after burningin is :[ 0.86297981  0.96954863  0.09666817]
cov of log_pars after burningin is :[[ 0.00676289 -0.00548952 -0.00535352]
 [-0.00548952  0.00445597  0.00434552]
 [-0.00535352  0.00434552  0.00423788]]
Acc_Rate:0.446
running time for MH estimation of size 1000 is 2723.12205815 seconds
estimated mod of parameters is ModeResult(mode=array([[ 0.84569585],
       [ 0.98158122],
       [ 0.0980405 ]]), count=array([[11],
       [11],
       [11]]))
estimated mean of parameters is [ 0.8375149   0.98791847  0.09894402]
estimated std of parameters is [ 0.03168682  0.03003853  0.00292954]
